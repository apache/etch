// This file automatically generated by:
//   @EtchVersion@ (@EtchBuildTag@) / csharp @EtchVersion@ (@EtchBuildTag@)
//   Tue Dec 18 04:15:44 GMT-06:00 2007

using System;
using System.Collections;
using System.Collections.Generic;
using System.Text;
using System.Runtime.CompilerServices;
using Etch.Util;
using Etch.Msg;
using Etch.Support;
using Etch.Transport;

namespace etch.examples.chat
{

///
///<summary> Main implementation for ChatListener. </summary>
///
public class MainChatListener : ChatHelper.ChatServerFactory
{
	///
 	/// <summary>Main for ChatListener.</summary>
	/// <param name="args"></param>
	///
	public static void Main(String[] args)
	{
		URL uri = new URL("tcp://127.0.0.1:4001");

		MainChatListener implFactory = new MainChatListener();
		Transport listener = ChatHelper.NewChatListener( uri, null, implFactory );

		listener.TransportControl( TransportConsts.START_AND_WAIT_UP, 4000 );
	}

	///
	/// <summary>Constructs the MainChatListener.</summary>
	///
	public MainChatListener()
	{
         whoIsOnline = new Dictionary<string, ChatServerImpl>();
	}
    public Dictionary<string, ChatServerImpl> whoIsOnline;

	///
	/// <summary>Return a new instance of ChatServer.</summary>
	/// @param client
	///
	public ChatServer NewChatServer( ChatClient client )
	{
        return new ChatServerImpl( client, whoIsOnline );
		//return new ImplChatServer( client );
	}
}

}